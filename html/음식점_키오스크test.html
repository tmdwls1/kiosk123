<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy KIOSK</title>
    <link rel="stylesheet" href="css/restaurant_kio.css">
    <script>

        // 상단 메뉴 클릭시 메뉴 전환
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.menu-grid');
            tabs.forEach(tab => tab.classList.add('hidden'));
            document.getElementById(tabName).classList.remove('hidden');

            const tabButtons = document.querySelectorAll('.tab');
            tabButtons.forEach(button => button.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }
        
        // 타이머 설정 
        let time = 120; 
        function startTimer() {
            const timerElement = document.querySelector('.timer .time');
            const interval = setInterval(() => {
                if (time > 0) {
                    time--;
                    timerElement.textContent = `${time}초`;
                } else {
                    clearInterval(interval); 
                }
            }, 1000); 
        }
        window.onload = startTimer;

        
        
        // 주문내역     
        const cartItems = []; // 주문 내역 저장

        function addToCart(name, price) {
            const cartList = document.getElementById('cart-items');

            // 이미 담은 상품인지 확인
            const existingItem = cartItems.find(item => item.name === name);
            if (existingItem) {
                existingItem.quantity++;
                updateCart();
                return;
            }

            // 새로운 상품 추가
            const newItem = { name, price, quantity: 1 };
            cartItems.push(newItem);
            updateCart();
        }

        // 담은 상품 목록 업데이트
        function updateCart() {
            const cartList = document.getElementById('cart-items');
            cartList.innerHTML = ''; // 기존 내용 초기화

            cartItems.forEach((item, index) => {
                const cartItem = document.createElement('li');
                cartItem.className = 'cart-item';

                cartItem.innerHTML = `
                    <button class="remove-btn" onclick="removeItem(${index})">X</button>
                    <span class="item-name">${item.name}</span>
                    <div class="item-controls">
                        <button onclick="decreaseQuantity(${index})">-</button>
                        <span>${item.quantity}개</span>
                        <button onclick="increaseQuantity(${index})">+</button>
                        <span>${item.price * item.quantity}원</span>
                    </div>
                `;

                cartList.appendChild(cartItem);
            });
            calculateTotal(); // 총 금액 업데이트
        }
        
        // 수량 증가 
        function increaseQuantity(index) {
            cartItems[index].quantity++;
            updateCart();
        }

        // 수량 감소
        function decreaseQuantity(index) {
            if (cartItems[index].quantity > 1) {
                cartItems[index].quantity--;
            } else {
                removeItem(index);
            }
            updateCart();
        }
        

        // 해당 상품 삭제
        function removeItem(index) {
            cartItems.splice(index, 1); 
            updateCart();
        }

        // 총 금액 계산
        function calculateTotal() {
            const total = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0); // 총 금액 계산
            const payButton = document.querySelector('.btn.pay');
            payButton.textContent = `${total}원 결제하기`; // 버튼에 총 금액 표시
        }

        //  상품 목록 전체 삭제
        function clearCart() {
            cartItems.length = 0;
            updateCart();
        }
        
    </script>
    <style>

        /* 결제하기 모달 창 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); 
            display: none; 
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background-color: white;
            border-radius: 10px;
            width: 600px; 
            height: 600px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between; 
        }

        .modal-header {
            color: #f0f0f0;
            background-color: #FF6347;
            padding: 10px;
            border-radius: 10px 10px 0 0;
            font-size: 20px;
            font-weight: bold;
        }

        /* 모달 내부에 공백 추가 */
        .modal-main {
            height: 100vh;
            margin: 20px;
        }

        .modal h2 {
            margin: 20px 0 10px;
            font-size: 18px;
        }

        .order-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        .order-table th, .order-table td {
            
            padding: 8px;
            text-align: center;
        }

        .order-table th {
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .summary {
            margin-top: 10px;
            text-align: left;
            font-size: 14px;
        }

        .summary div {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }

        .summary div span {
            font-weight: bold;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            border-top: 1px solid #ddd;
        }

        .modal-buttons .btn {
            padding: 10px 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }


        /* 결제 방법 선택 모달 창*/
        .payment-modal {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            width: 600px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 600px;
        }

        .payment-modal-header {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .payment-total {
            background-color: #FF6347;
            color: white;
            padding: 10px;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .payment-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .payment-option {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .payment-option:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .payment-option img {
            width: 50px;
            height: 50px;
            margin-bottom: 10px;
        }

        .payment-option span {
            font-size: 14px;
            font-weight: bold;
        }

        .pay1{
            background: url("img/결제/신용카드.png");
            background-size: cover;;

        }

    </style>
</head>
<body>
    
    <header>
        <div class="header">
            <div class="icon">🏠</div>
            <h1>음식점 키오스크</h1>
            <div class="icon">+</div>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="season-menu" onclick="showTab('season-menu')">메뉴1</div>
            <div class="tab" data-tab="coffee-hot" onclick="showTab('coffee-hot')">메뉴2</div>
            <div class="tab" data-tab="coffee-ice" onclick="showTab('coffee-ice')">메뉴3</div>
        </div>
    </header>    


    <main>
        <!-- 메뉴1 -->
        <div class="menu-grid" id="season-menu">
            <div class="menu-item" onclick="addToCart('된장찌개', 4000)">
                <img src="img/된장찌개.jpg" alt="된장찌개">
                <div class="name">된장찌개</div>
                <div class="price">4000원</div>
            </div>
            <div class="menu-item" onclick="addToCart('제육', 4800)">
                <img src="img/제육.jpg" alt="제육">
                <div class="name">제육</div>
                <div class="price">4800원</div>
            </div>
            <div class="menu-item" onclick="addToCart('김밥', 3800)">
                <img src="img/김밥.jpg" alt="김밥">
                <div class="name">김밥</div>
                <div class="price">3800원</div>
            </div>
            <div class="menu-item" onclick="addToCart('치즈김밥', 4000)">
                <img src="img/김밥.jpg" alt="치즈김밥">
                <div class="name">치즈김밥</div>
                <div class="price">4000원</div>
            </div>
            <div class="menu-item" onclick="addToCart('돈까스', 5000)">
                <img src="img/돈까스.jpg" alt="돈까스">
                <div class="name">돈까스</div>
                <div class="price">5000원</div>
            </div>
        </div>

        <!-- 메뉴2 -->
        <div class="menu-grid hidden" id="coffee-hot">
            <div class="menu-item">
                <img src="americano.png" alt="메뉴1">
                <div class="name">메뉴1</div>
                <div class="price">3000원</div>
            </div>
            <div class="menu-item">
                <img src="latte.png" alt="메뉴1">
                <div class="name">메뉴2</div>
                <div class="price">3500원</div>
            </div>
            <div class="menu-item">
                <img src="mocha.png" alt="메뉴1">
                <div class="name">메뉴3</div>
                <div class="price">4000원</div>
            </div>
        </div>

        <!-- 메뉴3 -->
        <div class="menu-grid hidden" id="coffee-ice">
            <div class="menu-item">
                <img src="iced-americano.png" alt="메뉴1">
                <div class="name">메뉴1</div>
                <div class="price">3500원</div>
            </div>
            <div class="menu-item">
                <img src="iced-latte.png" alt="메뉴1">
                <div class="name">메뉴2</div>
                <div class="price">4000원</div>
            </div>
            <div class="menu-item">
                <img src="iced-mocha.png" alt="메뉴1">
                <div class="name">메뉴3</div>
                <div class="price">4500원</div>
            </div>
        </div>
    </main>

    <footer>
        
        <!-- 주문 내역 및 버튼 -->
        <div class="order-section">

            <!-- 담은 물건 표시 영역 -->
            <div class="cart-section">
                <h3>담은 상품</h3>
                <ul id="cart-items">
                    <!-- 주문 내역이 여기에 추가됨 -->
                </ul>
            </div>

            <!-- 오른쪽 버튼 영역 -->
            <div class="button-section">
                <!-- 남은시간과 전체삭제 버튼 -->
                <div class="timer-delete-row">
                    <div class="timer">남은시간 <br><span class="time">0초</span></div>
                    <button class="btn delete" onclick="clearCart()">전체삭제</button>
                </div>

                <!-- 선택한 상품 버튼 -->
                <button class="btn select">선택한 상품</button>
                
                <!-- 결제하기 버튼 -->
                <button class="btn pay" onclick="calculateTotal()">결제하기</button>
            </div>
        </div>
    </footer>

    <!-- 주문 내역 확인 모달 창 -->
    <div class="modal-overlay" id="order-modal">
        <div class="modal">
            <div class="modal-header">주문내역확인</div>
            <div class="modal-main">
                <h2>주문 정보를 확인해 주세요.</h2>
                <table class="order-table">
                    <thead>
                        <tr>
                            <th>주문내역</th>
                            <th>수량</th>
                            <th>금액</th>
                        </tr>
                    </thead>
                    <tbody id="order-summary">
                        <!-- 주문 내역이 여기에 추가됩니다 -->
                    </tbody>
                </table>
                <div class="summary">
                    <div><span>총 수량:</span> <span id="total-quantity">0개</span></div>
                    <div><span>주문금액:</span> <span id="total-amount">0원</span></div>
                    <div><span>할인금액:</span> <span>0원</span></div>
                    <div><span>결제할 금액:</span> <span id="final-amount">0원</span></div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn store" onclick="confirmOrder()">결제하기</button>
                <button class="btn takeout" onclick="closeModal()">주문 취소</button>
            </div>
        </div>
    </div>

    <!-- 결제하기 모달 창 -->
    <div class="modal-overlay" id="payment-modal" style="display: none;">
        <div class="payment-modal">
            <div class="payment-modal-header">결제 방법을 선택해 주세요</div>
            <div class="payment-total">총 결제금액 | <span id="payment-total-amount">0원</span></div>
            
            <div class="payment-options">
                <div class="payment-option pay1" onclick="selectPayment('신용카드')">
                    <span>신용카드</span>
                </div>

                <div class="payment-option" onclick="selectPayment('페이')">
                    <img src="img/pay.png" alt="페이">
                    <span>페이</span>
                </div>

                <div class="payment-option" onclick="selectPayment('모바일 쿠폰')">
                    <img src="img/coupon.png" alt="모바일 쿠폰">
                    <span>모바일 쿠폰</span>
                </div>

                <div class="payment-option" onclick="selectPayment('바코드 할인')">
                    <img src="img/barcode.png" alt="바코드 할인">
                    <span>바코드 할인</span>
                </div>

                <div class="payment-option" onclick="selectPayment('기프트 카드')">
                    <img src="img/gift-card.png" alt="기프트 카드">
                    <span>기프트 카드</span>
                </div>

            </div>
        </div>
    </div>

    <script>

        // 모달창 열기

        function showModal() {
            const modal = document.getElementById('order-modal');
            const orderSummary = document.getElementById('order-summary');
            const totalQuantity = document.getElementById('total-quantity');
            const totalAmount = document.getElementById('total-amount');
            const finalAmount = document.getElementById('final-amount');
            modal.style.display = 'flex';

        
            orderSummary.innerHTML = '';
            let totalQty = 0;
            let totalPrice = 0;

            cartItems.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.quantity}</td>
                    <td>${item.price * item.quantity}원</td>
                `;
                orderSummary.appendChild(row);
                totalQty += item.quantity;
                totalPrice += item.price * item.quantity;
            });

            totalQuantity.textContent = `${totalQty}개`;
            totalAmount.textContent = `${totalPrice}원`;
            finalAmount.textContent = `${totalPrice}원`;
        }

        // 모달 창 닫기
        function closeModal() {
            const modal = document.getElementById('order-modal');
            modal.style.display = 'none';
        }

        // 주문 완료 알림창
        function confirmOrder() {
            closeModal(); // Close the order confirmation modal
            showPaymentModal(); // Show the payment method modal
        }

        // 결제하기 버튼 클릭 시 모달 열기
        document.querySelector('.btn.pay').addEventListener('click', showModal);

        // Show Payment Modal
        function showPaymentModal() {
            const paymentModal = document.getElementById('payment-modal');
            const paymentTotalAmount = document.getElementById('payment-total-amount');
            const totalAmount = document.getElementById('total-amount').textContent;
            paymentTotalAmount.textContent = totalAmount;
            paymentModal.style.display = 'flex';
        }

        // Close Payment Modal
        function closePaymentModal() {
            const paymentModal = document.getElementById('payment-modal');
            paymentModal.style.display = 'none';
        }

        // Select Payment Method
        function selectPayment(method) {
            alert(`${method} 결제가 선택되었습니다.`);
            closePaymentModal();
        }
    </script>
</body>
</html>